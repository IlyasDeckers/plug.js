(function(h,x,y){function m(){}function n(a,b){this.type=a;this._value=b}function p(){this._registrations={}}function q(){this._factories={}}function r(){this._prototypes={}}function t(a,b,c){this._factory=a;this._moduleConstructor=b;this._dependencies=c}function k(){this._register=new p;this._factoryStore=new q;this._prototypeStore=new r;this._objectModifier=new m}function u(){var a=new k,b;for(b in v)a.factory(b,v[b]);a.reference("window",h).reference("document",x).singleton("oMod",[m]);return a}
var l=Array.isArray,z=/^[^a-zA-Z$_]+|[^a-zA-Z_0-9$]+/gi,w=function(a,b){var c=function(){};c.prototype=a.prototype;c=new c;a.apply(c,b);return c},v={singleton:function(){var a;return{getInstance:function(b,c){a||(a=w(b,c));return a}}},"transient":function(){return{getInstance:function(a,b){return w(a,b)}}}};m.prototype=function(){function a(a,c){if(!l(a))throw Error("Value provided is not an array");return a.map(function(a){return c?b(a,c):a})}function b(d,c){c=c||!1;var f=d;switch(!0){case d instanceof
Element&&"object"===typeof d&&d.nodeName:f=d.cloneNode(c);break;case d instanceof Object||"object"===typeof d:f=c;if("object"!==typeof d)throw Error("Value provided is not an object");var e={},g;for(g in d)d.hasOwnProperty(g)&&(e[g]=f?b(d[g],f):d[g]);f=e;break;case d instanceof Array||l(d):f=a(d,c);break;case d instanceof Function||"function"===typeof d:if("function"!==typeof d)throw Error("Value provided is not a function");f=d.bind({});break;case d instanceof Date:f=new Date,f.setTime(d.getTime())}return f}
function c(a,b,f){a=a||{};for(var e in b)b.hasOwnProperty(e)&&(a[e]=f&&"object"===typeof b[e]?c(a[e],b[e],!0):b[e]);return a}return{clone:b,extend:function(a,b,f){if("object"!==typeof a)throw Error("Only objects can be extended");b=[].concat(b);for(var e=0;e<b.length;e++)c(a,b[e],f);return a}}}();n.prototype=function(){return{getValue:function(){var a=this._value;1===this.type&&(a=this._value.getInstance());return a}}}();p.prototype=function(){return{add:function(a,b,c){if("undefined"===typeof a||
"undefined"===typeof b)throw Error("Invalid registration");this._registrations[a]=new n(b,c)},retrieve:function(a){if(!l(a))throw Error("Must provide at least one name");for(var b=[],c=0;c<a.length;c++){var d=a[c];if("string"!==typeof d)throw Error("Invalid name provided");b.push({name:a[c],resolution:this._registrations[d]})}return b}}}();q.prototype=function(){return{add:function(a,b){this._factories[a]=b},retrieve:function(a){if("undefined"!==typeof this._factories[a]){a=new this._factories[a];
if("undefined"===typeof a.getInstance)throw Error("Factory must contain a 'getInstance' method");return a}}}}();r.prototype=function(){return{add:function(a,b){this._prototypes[a]=b},retrieve:function(a){a=[].concat(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];if("undefined"===typeof this._prototypes[d])throw Error("A prototype called "+d+" has not been registered");b.push(this._prototypes[d])}return b}}}();t.prototype=function(){return{getInstance:function(){var a=this._dependencies.map(function(a){return a.resolution?
a.resolution.getValue():y});return this._factory.getInstance(this._moduleConstructor,a)}}}();k.prototype=function(){return{value:function(a,b,c){b=this._objectModifier.clone(b,c);this._register.add(a,2,b);return this},reference:function(a,b){this._register.add(a,2,b);return this},factory:function(a,b){if("string"!==typeof a||"function"!==typeof b)throw Error("A valid factory must be supplied");var c=a.replace(z,"");this._factoryStore.add(c,b);this[c]=function(a,b,f){if("string"!==typeof a||!l(b))throw Error("Invalid module registration");
if(1>=b.length&&"function"!==typeof b[0])throw Error("Module registration requires a constructor function");var e=b.pop();if("function"!==typeof e)throw Error("Last parameter of constructor array must be a constructor function");var g=this._factoryStore.retrieve(c);b=this._register.retrieve(b);f&&(f=this._prototypeStore.retrieve(f),e.prototype=this._objectModifier.extend(e.prototype,f));e=new t(g,e,b);this._register.add(a,1,e);return this}},from:function(a,b){if("string"!==typeof a||"object"!==typeof b)throw Error("A valid prototype must be supplied");
this._prototypeStore.add(a,b);return this},resolve:function(a){a=this._register.retrieve([].concat(a));if(1==a.length)return a[0].resolution.getValue();for(var b={},c=0;c<a.length;c++){var d=a[c];"undefined"!==typeof d.resolution&&(b[d.name]=d.resolution.getValue())}return b}}}();k.prototype.create=u;(function(){if(!(h.plug&&h.plug instanceof k)){var a=u();h.plug=a}})()})(window,document);
