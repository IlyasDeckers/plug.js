(function(k,x,y){function m(){}function n(a,b){this.type=a;this._value=b}function p(){this._registrations={}}function q(){this._factories={}}function r(){this._prototypes={}}function t(a,b,c){this._factory=a;this._moduleConstructor=b;this._dependencies=c}function l(){this._register=new p;this._factoryStore=new q;this._prototypeStore=new r;this._objectModifier=new m}function u(){var a=new l,b;for(b in v)a.factory(b,v[b]);a.reference("window",k).reference("document",x).singleton("objectModifier",m);
return a}var h=Array.isArray,z=/^[^a-zA-Z$_]+|[^a-zA-Z_0-9$]+/gi,w=function(a,b){function c(){return a.apply(this,b)}c.prototype=a.prototype;return new c},v={singleton:function(){var a;return{getInstance:function(b,c){a||(a=w(b,c));return a}}},"transient":function(){return{getInstance:function(a,b){return w(a,b)}}}};m.prototype=function(){function a(a,c){if(!h(a))throw Error("Value provided is not an array");return a.map(function(a){return c?b(a,c):a})}function b(d,c){c=c||!1;var e=d;switch(!0){case d instanceof
Element&&"object"===typeof d&&d.nodeName:e=d.cloneNode(c);break;case d instanceof Object||"object"===typeof d:e=c;if("object"!==typeof d)throw Error("Value provided is not an object");var f={},g;for(g in d)d.hasOwnProperty(g)&&(f[g]=e?b(d[g],e):d[g]);e=f;break;case d instanceof Array||h(d):e=a(d,c);break;case d instanceof Function||"function"===typeof d:if("function"!==typeof d)throw Error("Value provided is not a function");e=d.bind({});break;case d instanceof Date:e=new Date,e.setTime(d.getTime())}return e}
function c(a,b,e){a=a||{};for(var f in b)b.hasOwnProperty(f)&&(a[f]=e&&"object"===typeof b[f]?c(a[f],b[f],!0):b[f]);return a}return{clone:b,extend:function(a,b,e){if("object"!==typeof a)throw Error("Only objects can be extended");b=[].concat(b);for(var f=0;f<b.length;f++)c(a,b[f],e);return a}}}();n.prototype=function(){return{getValue:function(){var a=this._value;1===this.type&&(a=this._value.getInstance());return a}}}();p.prototype=function(){return{add:function(a,b,c){if("undefined"===typeof a||
"undefined"===typeof b)throw Error("Invalid registration");this._registrations[a]=new n(b,c)},retrieve:function(a){if(!h(a))throw Error("Must provide at least one name");for(var b=[],c=0;c<a.length;c++){var d=a[c];if("string"!==typeof d)throw Error("Invalid name provided");b.push({name:a[c],resolution:this._registrations[d]})}return b}}}();q.prototype=function(){return{add:function(a,b){this._factories[a]=b},retrieve:function(a){if("undefined"!==typeof this._factories[a]){a=new this._factories[a];
if("undefined"===typeof a.getInstance)throw Error("Factory must contain a 'getInstance' method");return a}}}}();r.prototype=function(){return{add:function(a,b){this._prototypes[a]=b},retrieve:function(a){if(!h(a))throw Error("Must provide at least one name");for(var b=[],c=0;c<a.length;c++){var d=a[c];if("undefined"===typeof this._prototypes[d])throw Error("A prototype called "+d+" has not been registered");b.push(this._prototypes[d])}return b}}}();t.prototype=function(){return{getInstance:function(){var a=
this._dependencies.map(function(a){return a.resolution?a.resolution.getValue():y});return this._factory.getInstance(this._moduleConstructor,a)}}}();l.prototype=function(){return{value:function(a,b,c){b=this._objectModifier.clone(b,c);this._register.add(a,2,b);return this},reference:function(a,b){this._register.add(a,2,b);return this},factory:function(a,b){if("string"!==typeof a||"function"!==typeof b)throw Error("A valid factory must be supplied");var c=a.replace(z,"");this._factoryStore.add(c,b);
this[c]=function(a,b){if("undefined"===typeof a||!h(b))throw Error("Invalid module registration");if(1>=b.length&&"function"!==typeof b[0])throw Error("Module registration requires a constructor function");var e=b.pop();if("function"!==typeof e)throw Error("Last parameter of constructor array must be a constructor function");var f=this._factoryStore.retrieve(c),g=this._register.retrieve(b),e=new t(f,e,g);this._register.add(a,1,e);return this}},from:function(a,b){if("string"!==typeof a||"object"!==
typeof b)throw Error("A valid prototype must be supplied");this._prototypeStore.add(a,b);return this},resolve:function(a){a=this._register.retrieve([].concat(a));if(1==a.length)return a[0].resolution.getValue();for(var b={},c=0;c<a.length;c++){var d=a[c];"undefined"!==typeof d.resolution&&(b[d.name]=d.resolution.getValue())}return b}}}();l.prototype.create=u;(function(){if(!(k.plug&&k.plug instanceof l)){var a=u();k.plug=a}})()})(window,document);
