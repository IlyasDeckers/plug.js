(function(k,x,y){function n(){}function p(a,c){this.type=a;this._value=c}function q(){this._registrations={}}function r(){this._factories={}}function t(a,c,d){this._factory=a;this._moduleConstructor=c;this._dependencies=d}function l(){this._register=new q;this._factoryStore=new r;this._objectModifier=new n}function u(){var a=new l,c;for(c in v)a.factory(c,v[c]);a.reference("window",k).reference("document",x).singleton("oMod",[n]);return a}var m=Array.isArray,z=/^[^a-zA-Z$_]+|[^a-zA-Z_0-9$]+/gi,w=
function(a,c){var d=function(){};d.prototype=a.prototype;d=new d;a.apply(d,c);return d},v={singleton:function(){var a;return{getInstance:function(c,d){a||(a=w(c,d));return a}}},"transient":function(){return{getInstance:function(a,c){return w(a,c)}}}};n.prototype=function(){function a(b,a){if(!m(b))throw Error("Value provided is not an array");return b.map(function(b){return a?c(b,a):b})}function c(b,d){d=d||!1;var e=b;switch(!0){case b instanceof Element&&"object"===typeof b&&b.nodeName:e=b.cloneNode(d);
break;case b instanceof Object||"object"===typeof b:e=d;if("object"!==typeof b)throw Error("Value provided is not an object");var f={},h;for(h in b)b.hasOwnProperty(h)&&(f[h]=e?c(b[h],e):b[h]);e=f;break;case b instanceof Array||m(b):e=a(b,d);break;case b instanceof Function||"function"===typeof b:if("function"!==typeof b)throw Error("Value provided is not a function");e=b.bind({});break;case b instanceof Date:e=new Date,e.setTime(b.getTime())}return e}function d(b,c,a){b=b||{};for(var f in c)c.hasOwnProperty(f)&&
(b[f]=a&&"object"===typeof c[f]?d(b[f],c[f],!0):c[f]);return b}return{clone:c,extend:function(b,c,a){if("object"!==typeof b)throw Error("Only objects can be extended");c=[].concat(c);for(var f=0;f<c.length;f++)d(b,c[f],a);return b}}}();p.prototype=function(){return{getValue:function(){var a=this._value;1===this.type&&(a=this._value.getInstance());return a}}}();q.prototype=function(){return{add:function(a,c,d){if("undefined"===typeof a||"undefined"===typeof c)throw Error("Invalid registration");this._registrations[a]=
new p(c,d)},retrieve:function(a){if(!m(a))throw Error("Must provide at least one name");for(var c=[],d=0;d<a.length;d++){var b=a[d];if("string"!==typeof b)throw Error("Invalid name provided");c.push({name:a[d],resolution:this._registrations[b]})}return c}}}();r.prototype=function(){return{add:function(a,c){this._factories[a]=c},retrieve:function(a){if("undefined"!==typeof this._factories[a]){a=new this._factories[a];if("undefined"===typeof a.getInstance)throw Error("Factory must contain a 'getInstance' method");
return a}}}}();t.prototype=function(){return{getInstance:function(){var a=this._dependencies.map(function(c){return c.resolution?c.resolution.getValue():y});return this._factory.getInstance(this._moduleConstructor,a)}}}();l.prototype=function(){function a(c,a,b,g){if("string"!==typeof c||!m(b))throw Error("Invalid module registration");if(1>=b.length&&"function"!==typeof b[0])throw Error("Module registration requires a constructor function");var e=b.pop();if("function"!==typeof e)throw Error("Last parameter of constructor array must be a constructor function");
a=this._factoryStore.retrieve(a);b=this._register.retrieve(b);g&&(g=this._register.retrieve(g).map(function(c){return c.resolution.getValue()}),e.prototype=this._objectModifier.extend(e.prototype,g));e=new t(a,e,b);this._register.add(c,1,e);return this}return{value:function(c,a,b){a=this._objectModifier.clone(a,b);this._register.add(c,2,a);return this},reference:function(c,a){this._register.add(c,2,a);return this},factory:function(c,d){if("string"!==typeof c||"function"!==typeof d)throw Error("A valid factory must be supplied");
var b=c.replace(z,"");this._factoryStore.add(b,d);this[b]=function(c,d,f){a.call(this,c,b,d,f);return this}},from:function(c,a){if("string"!==typeof c||"object"!==typeof a)throw Error("A valid prototype must be supplied");this._register.add(c,3,a);return this},resolve:function(a){a=this._register.retrieve([].concat(a));if(1==a.length)return a[0].resolution.getValue();for(var d={},b=0;b<a.length;b++){var g=a[b];"undefined"!==typeof g.resolution&&(d[g.name]=g.resolution.getValue())}return d}}}();l.prototype.create=
u;(function(){if(!(k.plug&&k.plug instanceof l)){var a=u();k.plug=a}})()})(window,document);
